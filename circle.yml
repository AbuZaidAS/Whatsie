machine:
  node:
    version: 0.12.0

dependencies:
  override:
    - npm install --only=dev
  post:
    - >
      if [[ ($CIRCLE_BRANCH == 'staging' || $CIRCLE_BRANCH == 'deploy') && -z $CI_PULL_REQUEST ]]; then
        ./scripts/linux/dependencies.sh;
      fi
  cache_directories:
    - node_modules
    - src/node_modules
    - cache

deployment:
  staging:
    branch: staging
    commands:
      - ./scripts/linux/build_staging.sh
  deploy:
    branch: deploy
    commands:
      - ./scripts/linux/build_deploy.sh

notify:
  webhooks:
    - url: https://webhooks.gitter.im/e/5d0ef61f9481b64c412e
